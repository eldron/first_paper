(function(){var be=NEJ.P,bZ=NEJ.O,bj=be("nej.v"),bm=be("nej.u"),bH=be("nej.j"),bK=be("nej.ut"),bq=be("nm.x"),bp=be("nm.d"),uk="track-queue",byc="track-history",qR="player-setting",jO="random-queue",bb,bJ;var NX=function(){var pe=function(byd,byf){return Math.random()-.5};return function(ck){for(var i=0,bk=[];i<ck;++i)bk[i]=i;bk.sort(pe);return bk}}();bp.fW=NEJ.C();bb=bp.fW.bN(bp.gY);bb.cw=function(bf){this.cA(bf);this.bue()};bb.bue=function(){var kb=!1;return function(){if(kb)return;kb=!0;this.zq(qR,{mode:4,volume:.5,autoplay:!1,index:-1,lock:!0});var gw=this.zq(uk,[]);this.lI(jO,NX(gw.length))}}();bb.iQ=function(){return this.Gj(qR)};bb.jP=function(bF,bz,deleted){var bl=this.iQ(),bub=bl[bF];bl[bF]=bz;this.sv(qR,bl);bj.bG(bp.fW,"settingchange",{key:bF,newValue:bz,oldValue:bub,deleted:deleted})};bb.gU=function(ln,BN,Di){var btR=this.iQ().index;this.jP("index",ln);if(BN===undefined)BN=true;bj.bG(bp.fW,"playchange",{newValue:ln,oldValue:btR,autoplay:BN,endtype:Di})};bb.rk=function(ln,BN,Di,tw){var bk=this.gO();if(!bk||!bk[ln])return;if(bq.jC(bk[ln]))ln=this.bty(ln,tw);if(ln<0){bj.bG(bp.fW,"playerror",{code:403});return}this.gU(ln,BN,Di)};bb.qu=function(){return this.iQ().index};bb.WB=function(fy){if(!fy||bm.fz(fy)&&!fy.length)return;var bk=this.gO();!bm.fz(fy)?bk.push(fy):Array.prototype.push.apply(bk,fy);var ft=1e3;if(bk.length>ft){var ys=this.qu(),BI=bk.length-ft;if(ys>=0&&ys<BI){var WF=bk.splice(0,BI+1);if(WF[ys]){bk.unshift(WF[ys]);this.jP("index",0)}}else{bk.splice(0,BI);if(ys>=BI)this.jP("index",ys-BI)}}this.sv(uk,bk);this.lI(jO,NX(bk.length));bj.bG(bp.fW,"queuechange",{queue:bk})};bb.gO=function(){return this.Gj(uk)};bb.WG=function(fy,dO){this.sv(uk,[]);if(!fy||!fy.length){bj.bG(bp.fW,"queuechange",{queue:[]});this.lI(jO,[])}else{this.WB(fy)}if(dO!==undefined)this.gU(dO===0?-1:0,true,3)};bb.WH=function(){this.sv(uk,this.Gj(uk))};bb.bEM=function(PW){if(PW){this.WG([]);this.jP("index",-1);return}var BG=this.iQ().index,WK=this.jD(BG);if(WK){this.WG([WK]);this.jP("index",0)}};bb.Eo=function(){var rn=/^\/m\/(album|playlist|dj)\?id=(\d+)/;var Ev=function(bU,bQ){if(!bU)return;if(!bQ){bU.from={};return}if(!bQ.fid){var cp={dj:17,album:19,playlist:13},rv=(bQ.fhref||"").match(rn);if(rv){bQ.fid=cp[rv[1]];bQ.fdata=rv[2]}}bU.from={fid:bQ.fid,fdata:bQ.fdata,fhref:bQ.fhref}};return function(bk,bQ){if(!bk||!bk.length)return;var gw=this.gO();for(var i=0,bu=-1,nl=[];i<bk.length;++i){bu=this.sB(bk[i].id,bQ.fid,bQ.fdata);if(bu>=0)continue;nl.push(bk[i])}bm.cs(nl,function(bt){Ev(bt,bQ)});this.WB(nl)}}();bb.WO=function(bu){var bk=this.gO();if(bu<0||bu>=bk.length)return;bl=bk.splice(bu,1);this.sv(uk,bk);this.lI(jO,NX(bk.length));bj.bG(bp.fW,"queuechange",{queue:bk,index:bu,deleted:!0});var BG=this.iQ().index;if(bu<BG){this.jP("index",BG-1,"deleted")}else if(bu==BG){this.rk(bu==bk.length?bu-1:this.sD(),!1,3)}return bl};bb.jD=function(bu){var bk=this.gO();return bk[bu]};bb.sD=function(){var bk=this.gO(),fj=this.iQ();if(!bk||!bk.length)return-1;if(fj.index!=-1)return fj.index;var bu=fj.mode==5?bm.DZ(0,bk.length):Math.max(Math.min(fj.index,bk.length),0);return bu};bb.Nv=function(){var bk=this.gO(),fj=this.iQ();if(!bk||!bk.length)return-1;var bu=(fj.index-1+bk.length)%bk.length;if(fj.mode==5){var jY=this.mt(jO),lq=Math.max(0,bm.dY(jY,fj.index));lq=(lq-1+jY.length)%jY.length;bu=jY[lq]}if(bu===undefined)bm.DZ(0,bk.length);return bu};bb.Bz=function(){var bk=this.gO(),fj=this.iQ();if(!bk||!bk.length)return-1;var bu=(fj.index+1)%bk.length;if(fj.mode==5){var jY=this.mt(jO),lq=Math.max(0,bm.dY(jY,fj.index));lq=(lq+1)%jY.length;bu=jY[lq]}if(bu===undefined)bm.DZ(0,bk.length);return bu};bb.bty=function(ln,tw){var bk=this.gO(),fj=this.iQ();if(!bk||!bk.length)return-1;var dm=0,bu,bU;do{dm++;if(!tw){bu=(ln+1)%bk.length;if(fj.mode==5){var jY=this.mt(jO),lq=Math.max(0,bm.dY(jY,ln));lq=(lq+1)%jY.length;bu=jY[lq]}}else{bu=(ln-1+bk.length)%bk.length;if(fj.mode==5){var jY=this.mt(jO),lq=Math.max(0,bm.dY(jY,ln));lq=(lq-1+jY.length)%jY.length;bu=jY[lq]}}bU=bk[bu];if(bU&&!bq.jC(bU))return bu;ln=bu}while(dm<bk.length);return-1};bb.sB=function(vo,AR,bcp){var gw=this.gO();if(!gw||!gw.length)return-1;return bm.dY(gw,function(bt){if(bt.id!=vo)return!1;var dz=bt.from;if(!dz)return!1;else return!0})};bb.Ef=function(cF){if(!cF)return;var pi=bH.fN("playlist")||"";pi=!pi?[]:pi.split("|");var bu=bm.dY(pi,cF+"");if(bu>=0)pi.splice(bu,1);pi.unshift(cF);if(pi.length>8)pi.splice(8,pi.length-8);bH.fN("playlist",{value:pi.join("|"),expires:7})};bK.hh.bL({element:bp.fW,event:["playchange","queuechange","settingchange","playresource","playerror"]})})();
(function(){var be=NEJ.P,bZ=NEJ.O,Fp=be("nej.e"),bj=be("nej.v"),bm=be("nej.u"),bK=be("nej.ut"),eb=be("nm.u"),bb,bJ;eb.vN=NEJ.C();bb=eb.vN.bN(bK.eW);bb.dv=function(){var JG=function(bX){bj.bs(this.cz,bX,this.bsS.bh(this,bX))};return function(){this.dF();this.cz=new Audio;this.iT=["play","pause","ended","playing","progress","loadeddata","timeupdate","error","emptied"];bm.cs(this.iT,JG,this);this.Nj=0;this.Bw=0}}();bb.cX=function(){this.oX();this.dc()};bb.oX=function(){if(!this.cz.currentSrc)return;this.DX();try{this.cz.currentTime=0}catch(e){}this.cz.pause();this.cz.src=""};bb.bsS=function(bX){switch(bX){case"play":case"loadeddata":if(bX=="loadeddata")this.DX();this.bG("onstatechange",{state:0});break;case"pause":this.bG("onstatechange",{state:2});break;case"ended":this.bG("onstatechange",{state:4});break;case"playing":this.bG("onstatechange",{state:1});break;case"progress":if(!this.cz.buffered.length)return;var Fp=this.cz.buffered.end(0);this.bG("onloadprogress",{loaded:Fp,duration:this.cz.duration});break;case"timeupdate":this.bG("onplayprogress",{current:this.cz.currentTime,duration:this.cz.duration});break;case"emptied":break;case"error":var cS=this.cz.error,bU=this.cz.currentSrc,DV=this.cz.currentTime;if(cS){switch(cS.code){case cS.MEDIA_ERR_ABORTED:case cS.MEDIA_ERR_DECODE:case cS.MEDIA_ERR_ENCRYPTED:this.bG("onplayerror",{error:cS.code,src:bU,time:DV});break;case cS.MEDIA_ERR_NETWORK:this.Bt(bU,DV);break;case cS.MEDIA_ERR_SRC_NOT_SUPPORTED:if(!!this.cz.src&&this.cz.src!="http://"+location.host+"/"&&this.cz.src.indexOf("#")<0){this.bG("onplayerror",{error:cS.code,src:bU,time:DV})}break;default:this.bG("onplayerror",{error:-1,src:bU,time:DV});break}}break}};bb.gJ=function(dW,Xh,un){this.DX();this.cz.src=dW;if(un===undefined)un=true;if(un){this.cz.play()}};bb.DX=function(){this.Bw=0;this.Nj=clearTimeout(this.Nj)};bb.Bt=function(dW,MW){if(!dW||this.Bw>5){if(this.Bw>5)this.bG("onplayerror",{error:2,src:dW,time:MW});this.DX();return}if(this.Bw>0){var bu=dW.indexOf("#");dW=bu>=0?dW.substring(0,bu):dW;this.cz.src=dW+"#t="+MW;this.cz.play()}this.Bw++;this.Nj=setTimeout(arguments.callee.bh(this,dW,MW),5e3)};bb.hY=function(){this.cz.pause()};bb.ke=function(){this.cz.play()};bb.cu=function(){this.oX();this.bG("onstatechange",{state:3})};bb.lu=function(hW){if(!this.cz.currentSrc)return;this.cz.currentTime=this.cz.duration*hW};bb.bsv=function(Bp){this.cz.muted=!!Bp;this.bG("onmutedchange",{muted:Bp})};bb.jZ=function(bz){this.cz.volume=bz;this.bG("onvolumechange",{value:bz})};bb.pn=function(){return this.cz.currentTime>0&&!this.cz.ended&&!this.cz.paused}})();
(function(){var be=NEJ.P,bZ=NEJ.O,Fp=be("nej.e"),bj=be("nej.v"),bm=be("nej.u"),bK=be("nej.ut"),eb=be("nm.u"),bb,bJ;eb.sZ=NEJ.C();bb=eb.sZ.bN(bK.eW);bb.dv=function(){this.dF();Fp.qK({src:"http://music.163.com/style/swf/CloudMusicPlayer.swf?v=2014060988888",hidden:true,parent:document.body,params:{flashvars:"hostname="+location.hostname,allowscriptaccess:"always",wmode:"transparent"},onready:this.MG.bh(this)});window.onIoError=this.oD.bh(this);window.onLoadProgress=this.oB.bh(this);window.onPlayProgress=this.mQ.bh(this);window.onPlayComplete=this.bsf.bh(this)};bb.cX=function(){this.oX();this.bsP()};bb.MG=function(gh){this.cz=gh;if(typeof console==="undefined"){console={}}console.aslog=this.bse.bh(this);this.jZ(this.bsa);this.gJ(this.fw)};bb.bse=function(cD){this.cz.as_postMessage(cD)};bb.oX=function(){delete this.fw;if(this.cz){this.cz.as_stop();this.cz.as_clear()}};bb.oD=function(cS){this.bG("onplayerror",{name:"ioerror",code:cS})};bb.oB=function(nF,df){if(this.gS<1)return;this.bG("onloadprogress",{loaded:nF/1e3,duration:df/1e3})};bb.mQ=function(brQ,df){this.gS=df;this.bG("onplayprogress",{current:brQ/1e3,duration:df/1e3})};bb.bsf=function(bl){this.bG("onstatechange",{state:4})};bb.gJ=function(dW,Xh,un){this.oX();if(!dW)return;this.fw=dW;this.gS=0;if(this.cz){this.cz.as_addSong({id:Xh,url:this.fw});if(un===undefined)un=true;if(un){this.cz.as_play();this.bG("onstatechange",{state:1})}}};bb.hY=function(){if(this.cz&&this.fw){this.cz.as_pause();this.bG("onstatechange",{state:2})}};bb.ke=function(){if(this.cz&&this.fw){this.cz.as_play();this.bG("onstatechange",{state:1})}};bb.cu=function(){this.oX();this.bG("onstatechange",{state:3})};bb.lu=function(hW){if(!this.cz||!this.fw)return;this.cz.as_setPosition(this.gS*hW);this.cz.currentTime=this.cz.duration*hW};bb.bsv=function(Bp){if(this.cz)this.cz.as_setMuted(!!Bp);this.bG("onmutedchange",{muted:Bp})};bb.jZ=function(bz){this.bsa=bz;if(this.cz)this.cz.as_setVolume(bz);this.bG("onvolumechange",{value:bz})};bb.pn=function(){return this.cz&&this.cz.as_isPlaying()}})();
(function(){var be=NEJ.P,bZ=NEJ.O,co=NEJ.F,bv=be("nej.ut"),bb;if(!!bv.Sx)return;bv.Sx=NEJ.C();bb=bv.Sx.bN(bv.eW);bb.cw=function(bf){this.cA(bf);this.Il=bf.to||bZ;this.Dw=bf.from||{};this.bhj=Math.max(0,parseInt(bf.delay)||0)};bb.cX=function(){this.dc();this.cu();if(!!this.Dv){window.clearTimeout(this.Dv);delete this.Dv}delete this.Il;delete this.Dw};bb.Tc=function(cr){if(!this.Dw)return;if((""+cr).indexOf(".")>=0)cr=+(new Date);if(this.Td(cr)){this.cu();return}this.dQ=requestAnimationFrame(this.Tc.bh(this))};bb.Td=co;bb.gJ=function(){var bhk=function(){this.Dv=window.clearTimeout(this.Dv);this.Dw.time=+(new Date);this.dQ=requestAnimationFrame(this.Tc.bh(this))};return function(){this.Dv=window.setTimeout(bhk.bh(this),this.bhj);return this}}();bb.cu=function(){this.dQ=cancelRequestAnimationFrame(this.dQ);this.bG("onstop");return this}})();
(function(){var be=NEJ.P,bZ=NEJ.O,bm=be("nej.u"),bv=be("nej.ut"),bb,bJ;if(!!bv.tj)return;bv.tj=NEJ.C();bb=bv.tj.bN(bv.Sx);bJ=bv.tj.du;bb.cw=function(bf){this.cA(bf);this.So=bf.duration||200;this.bjo=1/(200*this.So);this.bjB(bf.timing);this.bjN()};bb.cX=function(){this.dc();delete this.wH;delete this.Sa};bb.bjB=function(){var fg=/^cubic\-bezier\((.*?)\)$/i,hy=/\s*,\s*/i,Tm={linear:[0,0,1,1],ease:[.25,.1,.25,1],easein:[.42,0,1,1],easeout:[0,0,.58,1],easeinout:[0,0,.58,1]};var bkz=function(bz,bu,bk){bk[bu]=parseFloat(bz)};return function(HT){HT=(HT||"").toLowerCase();this.wH=Tm[HT];if(fg.test(HT)){this.wH=RegExp.$1.split(hy);bm.cs(this.wH,bkz)}if(!!this.wH)return;this.wH=Tm.ease}}();bb.bjN=function(){var xi=this.wH,RW=3*xi[0],Tr=3*(xi[2]-xi[0])-RW,bkU=1-RW-Tr,RV=3*xi[1],Tu=3*(xi[3]-xi[1])-RV,blO=1-RV-Tu;this.Sa={ax:bkU,ay:blO,bx:Tr,by:Tu,cx:RW,cy:RV}};bb.bfG=function(){var Tx=function(cr,le){return((le.ax*cr+le.bx)*cr+le.cx)*cr};var bnh=function(cr,le){return((le.ay*cr+le.by)*cr+le.cy)*cr};var bod=function(cr,le){return(3*le.ax*cr+2*le.bx)*cr+le.cx};var bpo=function(cr,TC,le){var t0,t1,t2,x2,d2,i;for(t2=cr,i=0;i<8;i++){x2=Tx(t2,le)-cr;if(Math.abs(x2)<TC)return t2;d2=bod(t2,le);if(Math.abs(d2)<1e-6)break;t2=t2-x2/d2}t0=0;t1=1;t2=cr;if(t2<t0)return t0;if(t2>t1)return t1;while(t0<t1){x2=Tx(t2,le);if(Math.abs(x2-cr)<TC)return t2;if(cr>x2)t0=t2;else t1=t2;t2=(t1-t0)*.5+t0}return t2};return function(dP){return bnh(bpo(dP/this.So,this.bjo,this.Sa),this.Sa)}}();bb.Td=function(cr){var dP=cr-this.Dw.time,lS=this.bfG(dP),cl=bm.Cy(this.Dw.offset*(1-lS)+this.Il.offset*lS,2),nH=!1;if(dP>=this.So){cl=this.Il.offset;nH=!0}this.bG("onupdate",{offset:cl});return nH};bb.cu=function(){this.bG("onupdate",{offset:this.Il.offset});bJ.cu.apply(this,arguments);return this}})();
(function(){var be=NEJ.P,bv=be("nej.ut"),bb;if(!!bv.wi)return;bv.wi=NEJ.C();bb=bv.wi.bN(bv.tj);bb.cw=function(bf){bf=NEJ.X({},bf);bf.timing="easein";this.cA(bf)}})();
(function(){var be=NEJ.P,bZ=NEJ.O,fP=NEJ.R,Fp=be("nej.e"),bj=be("nej.v"),bv=be("nej.ut"),rW;if(!!bv.HM)return;bv.HM=NEJ.C();rW=bv.HM.bN(bv.eW);rW.dv=function(){this.hP={onchange:this.wZ.bh(this),ondragend:this.wZ.gz(this,!0)};this.dF()};rW.cw=function(bf){this.cA(bf);this.hP.view=Fp.bw(bf.track);this.hP.body=Fp.bw(bf.slide);this.hP.mbar=this.hP.view;this.Mk(bf.range);this.dA([[this.hP.view,"mousedown",this.brE.bh(this)]]);this.lb=bv.yo.bL(this.hP)};rW.cX=function(){this.dc();this.lb.ch();delete this.lb;delete this.iS;delete this.hP.view;delete this.hP.body;delete this.hP.mbar};rW.wZ=function(bc,iy){var XG=bc.left/this.iS.x[1],XH=bc.top/this.iS.y[1],XI=this.iS.x,XJ=this.iS.y;this.bG("onchange",{stopped:!!iy,x:{rate:XG,value:XG*(XI[1]-XI[0])},y:{rate:XH,value:XH*(XJ[1]-XJ[0])}})};rW.brE=function(bc){var cl=Fp.mV(this.hP.view),XK={x:bj.lB(bc),y:bj.oj(bc)},dP={x:Math.floor(this.hP.body.offsetWidth/2),y:Math.floor(this.hP.body.offsetHeight/2)};this.lb.fJ({top:XK.y-cl.y-dP.y,left:XK.x-cl.x-dP.x})};rW.Mk=function(gl){var sf;if(!!this.iS){var kt=this.lb.KI();sf={x:kt.left/this.iS.x[1],y:kt.top/this.iS.y[1]}}gl=gl||bZ;var brB=(gl.x||fP)[1]||this.hP.view.clientWidth-this.hP.body.offsetWidth,brr=(gl.y||fP)[1]||this.hP.view.clientHeight-this.hP.body.offsetHeight;this.iS={x:gl.x||[0,brB],y:gl.y||[0,brr]};if(!!sf)this.fJ(sf);return this};rW.fJ=function(sf){sf=sf||bZ;this.lb.fJ({top:this.iS.y[1]*(sf.y||0),left:this.iS.x[1]*(sf.x||0)})}})();
(function(){var bv=NEJ.P("nej.ut"),XO;if(!!bv.Bd)return;bv.Bd=NEJ.C();XO=bv.Bd.bN(bv.HM);XO.dv=function(){this.dF();this.hP.direction=2}})();
(function(){var be=NEJ.P,Fp=be("nej.e"),bj=be("nej.v"),bv=be("nej.ut"),pp;bv.wd=NEJ.C();pp=bv.wd.bN(bv.eW);pp.cw=function(bf){this.cA(bf);this.brb=!!bf.reset;this.HY=parseInt(bf.delta)||0;this.fw=Fp.bw(bf.track);this.XT=Fp.bw(bf.progress);this.dA([[bf.thumb,"mousedown",this.bra.bh(this)],[document,"mousemove",this.XV.bh(this)],[document,"mouseup",this.Mf.bh(this)],[this.fw,"mousedown",this.bqW.bh(this)]]);var hW=bf.value;if(hW==null){hW=this.XT.offsetWidth/this.fw.offsetWidth}this.fJ(hW)};pp.cX=function(){if(!!this.brb)this.Hu(0);this.dc()};pp.bra=function(bc){if(!!this.gd)return;bj.cu(bc);this.gd=bj.lB(bc);this.XZ=this.fw.offsetWidth};pp.XV=function(bc){if(!this.gd)return;var cl=bj.lB(bc),dP=cl-this.gd;this.gd=cl;this.Hu(this.we+dP/this.XZ);this.bG("onslidechange",{ratio:this.we})};pp.Mf=function(bc){if(!this.gd)return;this.XV(bc);delete this.gd;delete this.XZ;this.bG("onslidestop",{ratio:this.we})};pp.bqW=function(bc){var bqT=Fp.mV(this.fw).x,bqP=bj.lB(bc);this.Hu((bqP-bqT+this.HY)/this.fw.offsetWidth);this.bG("onslidestop",{ratio:this.we})};pp.Hu=function(hW){this.we=Math.max(0,Math.min(1,hW));Fp.bY(this.XT,"width",this.we*100+"%")};pp.fJ=function(hW){if(!!this.gd)return;this.Hu(hW)};pp.KI=function(hW){return this.we}})();
(function(){var be=NEJ.P,Fp=be("nej.e"),bj=be("nej.v"),bm=be("nej.u"),cQ=be("nej.ui"),bq=be("nm.x"),bE=be("nm.m.f"),bb,bJ;var KK=function(){var BA=function(jA,cW){if(!jA||!jA.name)return"";if(!jA.id)return'<span class="'+cW+'">'+bm.eZ(jA.name)+"</span>";return'<a class="'+cW+'"title="'+bm.eZ(jA.name)+'" data-jump="/artist?id='+jA.id+'" hidefocus="true">'+bm.eZ(jA.name)+"</a>"};return function(hD,bX,yx){if(!hD||!hD.length)return"";for(var i=0,bk=[],qy=[],jp;i<hD.length;++i){if(!hD[i]||hD[i].id<=0){qy.push(hD[i]);continue}if(bm.gj(bX)){jp=bX(hD[i])}else{jp=BA(hD[i],bX)}!!jp&&bk.push(jp)}for(var i=0,jp;i<qy.length;++i){if(bm.gj(bX)){jp=bX(qy[i])}else{jp=BA(qy[i],bX)}!!jp&&bk.push(jp)}return bk.join(yx||"/")}}();bE.KE=NEJ.C();bb=bE.KE.bN(cQ.pj);bb.cX=function(){Fp.bR(this.bB,"z-hover");this.gU(!1);this.dc()};bb.dt=function(){this.dn="m-player-playtrack"};bb.bFa=function(){this.dl();Fp.bV(this.bB,"js-iparent");var bk=Fp.bP(this.bB,"j-flag");this.lT=bk[0];this.IW=bk[1];bq.jK(this.bB,"z-hover")};bb.jl=function(){var IS=function(eD){if(!eD)return"";if(eD.program){var gr=eD.program.dj;return!gr?"":'<a  data-jump="/user/home?id='+gr.userId+'"title = "'+bm.eZ(gr.nickname)+'" hidefocus="true">'+bm.eZ(gr.nickname)+"</a>"}return KK(eD.artists)};return function(bl){this.lT.innerHTML=(bl.name||"")+(!bl.djprogram?"":"[DJ节目]");this.lT.title=(bl.name||"")+(!bl.djprogram?"":"[DJ节目]");this.IW.innerHTML=IS(bl)}}();bb.gU=function(oP){!oP?Fp.bR(this.bB,"z-cur"):Fp.bV(this.bB,"z-cur")}})();
(function(){var be=NEJ.P,eL=window,Fp=be("nej.e"),bj=be("nej.v"),bm=be("nej.u"),bK=be("nej.ut"),dX=be("nm.i"),bp=be("nm.d"),bq=be("nm.x"),bo=be("nm.l"),bM=be("nm.m"),eb=be("nm.u"),bE=be("nm.m.f"),bb,bJ;bE.Ky=NEJ.C();bb=bE.Ky.bN(bK.bFb);bb.cE=function(){this.cL();this.bB=Fp.eP("m-mailplayer-playlist");var gq=Fp.bP(this.bB,"j-flag");this.dk=gq[0];this.IA=gq[1];this.dA([[this.bB,"click",this.dH.bh(this)],[bp.fW,"queuechange",this.nj.bh(this)],[bp.fW,"settingchange",this.pd.bh(this)]]);this.bA=bp.fW.bL()};bb.eo=function(bf){var ix=this.bA.qu(),bk=this.bA.gO();this.dk.style.display=!bk.length?"none":"";this.IA.style.display=!bk.length?"":"none";this.dy=bE.KE.ch(this.dy);this.dy=Fp.sq(bk,bE.KE,{parent:this.dk});if(this.dy[ix]){this.dy[ix].gU(true);var bid=this.dk.parentNode,cl=ix*28;return;bid.scrollTop=Math.min(bid.scrollHeight,cl-28)}};bb.dH=function(){var BH=function(bid){var cT=bid;while(!!cT&&!Fp.cJ(cT,"js-iparent"))cT=cT.parentNode;return cT};var SA=function(bk,bid){if(!bk||!bk.length||!bid)return-1;var BO=BH(bid),bu=bm.dY(bk,function(bt){return bt.kw()===BO});return bu};return function(bc){var bid=bj.cf(bc);if(bid.href){if(/#$/.test(bid.href))bj.cG(bc);else return}var bid=bj.cf(bc,"d:action");var Bq=bj.cf(bc,"d:jump");if(!bid||Bq)return;bj.cG(bc);var cv=Fp.bI(bid,"action"),bu=SA(this.dy,bid);switch(cv){case"iplay":this.bA.gU(bu);break;case"idelete":location.hash="";this.bA.WO(bu);break}}}();bb.bJI=function(bc){if(!this.dy||!this.dy.length)return;var bt=this.dy[bc.oldValue];!!bt&&bt.gU(!1);bt=this.dy[bc.newValue];!!bt&&bt.gU(!0);if(bc.deleted!="deleted")this.fJ()};bb.nj=function(bc){this.bG("onrefresh")};bb.pd=function(bc){if(bc.key=="index"){this.bJI(bc)}};bb.cj=function(){this.bG("onhide");this.bG("onclose")};bb.nV=function(){return!!this.bB.parentNode&&!!this.bB.parentNode.tagName};bb.kw=function(){return this.bB};bb.fJ=function(){var ix=this.bA.qu();if(ix>=0){var bid=this.dk.parentNode,cl=ix*28;if(cl<bid.scrollTop||cl>=bid.scrollTop+28*10)bid.scrollTop=Math.min(bid.scrollHeight,cl)}}})();
(function(){var be=NEJ.P,eL=window,Fp=be("nej.e"),bj=be("nej.v"),bm=be("nej.u"),bv=be("nej.p"),bH=be("nej.j"),bK=be("nej.ut"),bp=be("nm.d"),bo=be("nm.l"),bq=be("nm.x"),bM=be("nm.m"),eb=be("nm.u"),bE=be("nm.m.f"),gi=be("window.player"),bb,bJ;var or=function(){var jB=bq.wg();if(jB>0)return!0;return!1};var qJ=function(){var AT=typeof GAbroad==="undefined"?!1:!!GAbroad;if(AT){return!0}return!1};bE.bcB=NEJ.C();bb=bE.bcB.bN(bK.bFb);bb.cE=function(){this.cL();this.bB=Fp.bP(document.body,"js-mailbox")[0];this.vS=Fp.bP(document.body,"icn-st")[0];this.hE=bm.nq();var gq=Fp.bP(this.bB,"j-flag");this.rg=Fp.bP(this.vS,"j-flag")[0];this.xp=gq[0];this.lf=gq[1];this.JV=gq[2];this.bky=gq[3];this.Cl=gq[4];this.rL=gq[5];this.dK=gq[6];this.iI=gq[7];var wo=Fp.dh(this.Cl);this.bqu=wo[0];this.nu=wo[1];this.bzv=wo[2];this.JQ=wo[4];var rC=Fp.bP(this.bky,"j-item");this.bzu=rC[0];this.bkD=rC[1];this.bcs=rC[2];this.eC=rC[3];this.hZ=rC[4];this.yz=false;var tl=bm.mk(location.search.split("?")[1]).host;WebmailHelper.init({cross:true,host:tl});WebmailHelper.setMusicBoxYyy=function(hO){WebmailHelper.cross("parent","$.AppInterface.cloudmusic.setMusicBox",hO)};WebmailHelper.goMusicBoxYyy=function(cg){WebmailHelper.cross("parent","$.AppInterface.cloudmusic.goMusicBox",{url:cg})};window.GX=location.hash;WebmailHelper.setMusicBoxYyy({height:24,width:34});setTimeout(function(){Fp.bY(this.vS,"visibility","visible")}.bh(this),500);this.nY=bK.wd.bL({track:rC[0],thumb:rC[3],progress:rC[2],value:0,onslidestop:this.AD.bh(this)});var JF=Fp.bP(this.rL,"j-t");this.AC=bK.HM.bL({track:JF[0],slide:JF[2],onchange:this.AA.bh(this)});this.Az=JF[1];var jB=bq.wg(),cW=jB==2?eb.vN:eb.sZ;window.cz=this.cz=cW.bL({onplayerror:this.oD.bh(this),onstatechange:this.ge.bh(this),onloadprogress:this.oB.bh(this),onplayprogress:this.mQ.bh(this)});this.gV=bp.qE.bL();this.bA=bp.fW.bL();this.iu=bp.np.bL();this.iu.bs("onresourceload",this.qh.bh(this));this.iu.bs("onresourceerror",this.uP.bh(this));this.dA([[this.bB,"click",this.dH.bh(this)],[this.vS,bv.dp.browser=="ie"?"mouseleave":"mouseout",this.bcn.bh(this,!1)],[this.vS,bv.dp.browser=="ie"?"mouseenter":"mouseover",this.bcn.bh(this,!0)],[this.vS,"click",this.bkJ.bh(this)],[this.eC,"mousedown",this.Rc.bh(this)],[document.body,"mouseup",this.Rd.bh(this)],[bp.fW,"playchange",this.bJI.bh(this)],[bp.fW,"queuechange",this.nj.bh(this)]]);if(typeof Hash!=="undefined"&&Hash.init){Hash.init(this.Hp.bh(this))}else{bj.bs(location,"urlchange",this.nz.bh(this));location.active()}this.bkK(bH.fN("playliststatus"));this.bkL()};bb.eo=function(bf){var bk=this.bA.gO(),fj=this.bA.iQ();this.cz.jZ(fj.volume);this.AC.fJ({x:fj.volume,y:0});this.jw(this.bA.jD(fj.index))};bb.jw=function(bU){if(!bU||!bU.mp3Url){this.cz.cu();this.nY.fJ(0);Fp.bV(this.Cl,"z-dis");this.xp.src="/style/web2/img/default/default_album.jpg";this.JV.innerHTML="";this.lf.innerHTML="";Fp.bI(this.lf,"jump","");Fp.bI(this.xp,"jump","");this.hZ.innerHTML="00:00 / 00:00";Fp.bY(this.bcs,"width","0%");this.nA("pause");return}Fp.bR(this.Cl,"z-dis");this.nY.fJ(0);this.xp.src=!bU.album||!bU.album.picUrl?"/style/web2/img/default/default_album.jpg":bU.album.picUrl+"?param=130x130";this.hZ.innerHTML="00:00 / 00:00";var dz=bq.Gs(bU.from),bl=NEJ.X({source:dz},bU);this.lf.innerHTML="<span title='"+bl.name+"'>"+bl.name+"</span>";this.JV.innerHTML=function(){var wr;if(!!bl.program){wr="<a class='s-fc4' data-jump='/user/home?id="+bl.program.dj.userId+"'title='"+bl.program.dj.nickname+"'>"+bl.program.dj.nickname+"</a>"}else{for(var cQ=0;cQ<bl.artists.length;cQ++){if(cQ==0){if(!!bl.artists[cQ].id)wr="<a class='s-fc4' data-jump='/artist?id="+bl.artists[cQ].id+"'title='"+bl.artists[cQ].name+"'>"+bl.artists[cQ].name+"</a>";else wr="<span class='s-fc4'>"+bl.artists[cQ].name+"</span>"}else{if(!!bl.artists[cQ].id)wr+="/"+"<a class='s-fc4' data-jump='/artist?id="+bl.artists[cQ].id+"'title='"+bl.artists[cQ].name+"'>"+bl.artists[cQ].name+"</a>";else wr+="/"+"<span class='s-fc4'>"+bl.artists[cQ].name+"</span>"}}}return wr}();if(!bU.program){Fp.bI(Fp.dh(this.lf)[0],"jump","/song?id="+bU.id);Fp.bI(this.xp,"jump","/song?id="+bU.id)}else{Fp.bI(Fp.dh(this.lf)[0],"jump","/dj?id="+bU.program.id);Fp.bI(this.xp,"jump","/dj?id="+bU.program.id)}Fp.bY(this.bcs,"width","0%")};bb.Rd=function(){this.rD=false};bb.Rc=function(){this.rD=true;Fp.bY(this.pN,"visibility","hidden")};bb.AD=function(bc){this.cz.lu(bc.ratio);this.rD=false};bb.AA=function(bc){var bz=bc.x.rate,dT=62*bz;Fp.bY(this.Az,"width",dT+"px");this.cz.jZ(bz);if(bc.stopped)this.bA.jP("volume",bz)};bb.oD=function(){location.hash=""};bb.ge=function(bc){if(bc.state==1||bc.state==2){var bu=this.bA.sD(),bU=this.bA.jD(bu)}if(bc.state==2||bc.state==3){Fp.bR(this.nu,"icn-pause");bc.state==2?Fp.bV(this.nu,"js-pause"):Fp.bR(this.nu,"js-pause");if(bc.state==3)document.title=bq.Ig();return}Fp.bV(this.nu,"icn-pause");Fp.bR(this.nu,"js-pause");if(bc.state==4){var eU=4;switch(eU){case 1:break;case 2:this.gJ();break;case 3:case 4:case 5:var gw=this.bA.gO();if(!gw.length){this.jw(null)}else{this.kW()}break}}};bb.oB=function(){var kM=0;return function(bc){Fp.bY(this.bkD,"width",bc.loaded*100/bc.duration+"%")}}();bb.mQ=function(){var kM=0;return function(bc){if(this.iM)this.iM.time=bc.current;var bK=+(new Date);if(bK-kM<1e3)return;kM=bK;this.nY.fJ(bc.current/bc.duration);this.hZ.innerHTML=bq.lx(bc.current)+" / "+bq.lx(bc.duration);var bC=bH.fN("playerid");if(!!bC&&bC!=this.hE)this.hY()}}();bb.bcn=function(){var qS=0,vo=0;return function(sN,bc){var bid=bj.cf(bc);if(bq.bcD(bc,this.vS)){if(sN){qS=+(new Date);vo=setTimeout(function(){WebmailHelper.setMusicBoxYyy({height:545,width:455});Fp.bY(this.bB,"visibility","visible");Fp.bY(this.bB,"display","block");if(this.fM)this.fM.fJ()}.bh(this),500)}else{WebmailHelper.setMusicBoxYyy({height:24,width:34});if(+(new Date)-qS<500){clearTimeout(vo);qS=0;console.log("hover 无效，防止误操作")}}}}}();bb.bkJ=function(bc){var ei=bj.cf(bc);if(Fp.cJ(ei,"outer"))return;var cg="http://music.163.com/musicbox?ref=mail"+window.GX;WebmailHelper.goMusicBoxYyy(cg)};bb.dH=function(bc){bj.lg(bc);var ei=bj.cf(bc);if(!Fp.cJ(ei,"j-vol")){Fp.bY(this.rL,"visibility","hidden")}var bid=bj.cf(bc,"d:action");var Bq=bj.cf(bc,"d:jump");if(!bid&&!Bq){return}bj.cG(bc);var cv=Fp.bI(bid,"action");if(Bq)var Gc=Fp.bI(Bq,"jump");switch(cv){case"prev":this.wQ();break;case"play":if(or()){this.cz.pn()?this.hY():Fp.cJ(bid,"js-pause")?this.ke():this.gJ()}break;case"next":this.kW();break;case"volum":if(this.rL.style.visibility!="hidden")Fp.bY(this.rL,"visibility","hidden");else Fp.bY(this.rL,"visibility","visible");break;case"unfold":this.bcm();break}if(Gc){var tl="http://music.163.com",FO;if(bH.fN("BOX_DISABLE")){FO="http://music.163.com/musicbox?ref=mail"+window.GX}else if(Gc.search(/\?/)!=-1){FO=tl+Gc+"&ref=mail"+window.GX}else{FO=tl+Gc+"?ref=mail"+window.GX}WebmailHelper.goMusicBoxYyy(FO)}};bb.bkR=function(bc){if(bc.code==200){this.bA.Eo(bc.tracks,bc.type,bc.rid,bc.from,2);if(bc.type==13)this.bA.Ef(bc.rid)}this.kh({rtype:bc.type,rid:bc.rid,code:bc.code,list:bc.tracks})};bb.bzq=function(){location.hash=""};bb.bJI=function(bc){if(bc.newValue!=bc.oldValue&&this.iM)this.gV.Sh(this.iM.id,this.iM.time);if(bc.newValue<0){this.jw(null);return}var bU=this.bA.jD(bc.newValue);if(!bU||!bU.mp3Url)return;if(!bU.program&&qJ())return;this.jw(bU);bH.fN("playerid",this.hE);if(!bc.autoplay){bc.autoplay=!Fp.cJ(this.nu,"js-pause")}this.cz.gJ(bU.mp3Url,bU.id,bc.autoplay);if(bc.autoplay)this.nA("play");else this.nA("pause")};bb.nj=function(){};bb.Hp=function(eq){var bc=location.parse(eq);this.nz(bc)};bb.kh=function(){};bb.nz=function(bc,br){if(bc.path==""||bc.path=="/app/cloudmusic/proxy.html")return;if(bv.dp.browser=="ie"&&parseInt(bv.dp.version)<=8){doPlay.call(this,bc)}else if(bH.fN("USER_TRIGGER")){bH.fN("USER_TRIGGER",{path:"/",expire:-1});doPlay.call(this,bc)}function doPlay(bc){bc=decodeURIComponent(bc.path);bc=JSON.parse(bc);this.If(bc.type,bc.id,bc.action,bc.play);this.nA("add")}};bb.wQ=function(){this.bA.gU(this.bA.Nv());this.nA("play")};bb.kW=function(){this.bA.gU(this.bA.Bz());this.nA("play")};bb.gJ=function(){this.bA.gU(this.bA.sD());this.nA("play")};bb.hY=function(){location.hash="";this.cz.hY();this.nA("pause")};bb.ke=function(){bH.fN("playerid",this.hE);this.cz.ke();this.nA("play")};bb.lu=function(hW){this.cz.lu(hW)};bb.mR=function(){return function(qb){if(qb){return}if(this.fM&&this.fM.nV())return}}();bb.qh=function(br,cF,bl,bQ){var fy=[];switch(br){case 2:fy=bl;break;case 13:fy=bl.tracks;break;case 17:bl.songs=[];var eD=NEJ.X({album:{}},bl.mainSong);eD.program=bl;eD.album.picUrl=bl.coverUrl;fy.push(eD);break;case 18:fy.push(bl);break;case 19:fy=bl.songs;break}bQ.rid=cF;bQ.type=br;this.uV(fy,bQ.play,bQ)};bb.uP=function(br,cF,dU){this.kh({rid:cF,type:br,code:dU,list:[]})};bb.uV=function(bk,dB,bQ){var bzn=this.bA.gO().length,length2;if(!bk||!bk.length)return;bQ=bQ||{};var cF=bQ.rid,br=bQ.type;if(dB&&br!=18&&br!=17){this.bA.bEM(true)}this.bA.Eo(bk,{fid:bQ.fid,fdata:bQ.fdata,fhref:bQ.fhref});if(dB){if(br==18||br==17){var bu=this.bA.sB(bk[0].id,bQ.fid,bQ.fdata);this.bA.gU(bu)}else{this.bA.gU(0)}}if(br==13)this.bA.Ef(cF);bzm=this.bA.gO().length;this.kh({rid:cF,type:br,code:200,list:bk})};bb.sJ=function(br,cF,dB,bQ){if(br!=17&&qJ())return;if(!or())return;bQ=bQ||{};var eq="";if(br==18){var bu=this.bA.sB(cF,bQ.fid,bQ.fdata);if(bu>=0){this.kh({rid:cF,type:br,code:200,list:[cF]});if(dB)this.bA.gU(bu);this.gV.ww({rid:cF,type:br,hash:eq,play:dB,source:bQ.fid,sourceid:bQ.fdata});return}}var bl={play:dB,fid:bQ.fid,fdata:bQ.fdata,fhref:eq};this.iu.uJ(parseInt(br),cF,{conf:bl});this.gV.ww({rid:cF,type:br,hash:eq,play:dB,source:bQ.fid,sourceid:bQ.fdata});return this.gV.Sm(br,cF)};bb.If=function(br,cF,cv,dB){if(cv=="stop"){this.nA("pause");return this.cz.hY()}if(cv=="addto")return this.sJ(br,cF,dB);else return this.sJ(br,cF,true)};bb.Ew=function(bU,br,cF,dz){if(br!=17&&qJ())return;if(!or())return;dz=dz||bq.uy();if(!bm.fz(bU)||bU.length==1){var bu=this.bA.sB(bU.id,br,cF,dz);if(bu>=0){this.bA.gU(bu);this.kh({rtype:br,rid:cF,code:200,list:[bU]});return}}this.bkR({code:200,rid:cF,type:br,from:dz,tracks:bm.fz(bU)?bU:[bU]})};bb.nA=function(va){var bk=this.bA.gO();if(this.yz)return;if(va=="play"){if(!bk.length)return;this.rg.src="/style/web2/img/mail/icn-play.gif";Fp.bY(this.rg,"margin-left","370px");Fp.bY(this.rg,"margin-top","2px")}else if(va=="pause"){this.rg.src="/style/web2/img/mail/icn-pau.png";Fp.bY(this.rg,"margin-left","368px");Fp.bY(this.rg,"margin-top","0px")}else if(va=="add"){this.yz=true;this.rg.src="/style/web2/img/mail/icn-add.gif";Fp.bY(this.rg,"margin-left","370px");Fp.bY(this.rg,"margin-top","2px");setTimeout(function(){this.yz=false;if(this.cz.pn())this.nA("play");else this.nA("pause")}.bh(this),800)}};bb.bcm=function(){!this.fM&&(this.fM=bE.Ky.bL());this.fM.nV()?Fp.bY(this.dK,"visibility","hidden"):Fp.bY(this.dK,"visibility","visible");this.fM.bG(this.fM.nV()?"onhide":"onshow",{parent:this.dK});!this.fM.nV()&&this.mR(false);if(this.fM.nV())bH.fN("playliststatus","visible");else bH.fN("playliststatus","invisible");this.fM.nV()?Fp.bV(this.JQ,"icn-plist-show"):Fp.bR(this.JQ,"icn-plist-show");if(this.fM){this.fM.fJ()}};bb.bkK=function(hO){if(hO=="visible"){!this.fM&&(this.fM=bE.Ky.bL());this.fM.bG("onshow",{parent:this.dK});Fp.bV(this.JQ,"icn-plist-show");if(this.fM){this.fM.fJ()}}else if(!hO){this.bcm()}else{Fp.bY(this.dK,"visibility","hidden")}};bb.bkL=function(){if(!(this.bA.gO()||[]).length&&GUser&&GUser.userId){this.bA.bEM(true);bH.cR("/api/user/playlist",{type:"json",method:"get",query:{offset:0,limit:50,uid:GUser.userId},onload:function(bc){if(bc.code==200){var bk=bc.playlist;for(var i=0;i<bk.length;i++){if(bk[i].trackCount){this.If(13,bk[i].id,"addto",false);return}}}}.bh(this)})}};Fp.dN("template-box");window.cz=this.cz=bE.bcB.bL();this.cz.bG("onshow",{});window.onload=function(){window.Ja=location.hash}})()