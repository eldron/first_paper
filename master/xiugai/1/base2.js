/*
 * 极速6欢迎页1元夺宝推广位
 * Author	 	Bob
 * CreateDate   2015-06-23
 * Copyright:	1997-2015 Netease Inc. All rights reserved.
 */

requirejs.config({baseUrl:G.url+G.ver+"/js/",paths:{pro:"http://mimg.127.net/p/tools/pro/pro-1.3.5.min"}}),define("base2",function(){}),define("component/base",["require","pro"],function(e){function r(){var e=this.constructor,n=this.__config;this.toString=u,"theme"in n?this.theme=n.theme:e.Theme&&(this.theme=new e.Theme);var r=this.theme;r&&(this.template=r.constructor.template,r.view=this);var i=e.pro;if(!t.version||t.version<i)throw new Error("请使用"+i+"及以上版本的pro.js");this.listen("disable",function(){this.dom.setAttribute("disabled","disabled"),this.addClass(e.getClassName("disabled")),this.model&&this.model.set("disabled",!0),this.theme&&this.theme.use("disabled")}),this.listen("resume",function(){this.dom.removeAttribute("disabled"),this.removeClass(e.getClassName("disabled")),this.model&&this.model.set("disabled",!1),this.theme&&this.theme.use(this.__config.color)}),this.listen("create",function(e){var t=this.__config,n=this.theme;n&&n.use(t.color),t.className&&this.addClass(t.className),t.subclass&&this.addClass(this.constructor.getClassName(t.subclass));if(t.style){var r="";if(typeof t.style=="string")r=t.style;else for(var i in t.style)r+=i+":"+t.style[i]+";";e.style.cssText+=(/;$/.test(e.style.cssText)||!e.style.cssText?"":";")+r}if(t.attr)for(var i in t.attr)e.setAttribute(i,t.attr[i])}),this.listen("render",function(){this.__config.disabled&&this.disable(),this.__config.hidden&&this.hide()})}function i(e){var t=this.theme?this.theme.baseClass:this._baseClassName;if(t){if(e){var n=e.split(" ");for(var r=0,i=n.length;r<i;r++)n[r]=t+"-"+n[r];return n.join(" ")}return t}return""}function s(e,t){var n=e?this.find(e):this.dom;t&&!n.getAttribute("tabindex")&&n.setAttribute("tabindex","0"),n.focus(),this.fire("focus",n)}function o(e){var t=e?this.find(e):this.dom;t.blur(),this.fire("blur",t)}function u(){return this.getHtml()}function a(e,n){n=t.mix(n,{dom:e,id:e.id});var r=new this(n);return r.getHtml(),r.dom.id||(r.dom.id=r.domId),r.activate(e),r}var t=e("pro"),n=t.View.extend(r,{pro:"1.3.0",version:"1.3.0",getClassName:i,by:a},{focus:s,blur:o,toHtml:u});return n}),define("component/numberinput",["require","pro","component/base"],function(e){var t=e("pro"),n=e("component/base");return n.extend(function(){var e=this.__config;this.listen("create",function(){this.step=e.step||1}),this.listen("disable",function(){this.doms.input.setAttribute("disabled","true")}),this.listen("resume",function(){this.doms.input.removeAttribute("disabled")}),this.listen(this.model,"change:value",function(e){this.fire("change",e)}),this.listen("change",e.onchange)},{_template:'<div class="pro-number"><a class="pro-number-btn pro-number-btn-minus" data-pro="minus" href="javascript:void(0);">－</a><input class="pro-number-input" data-pro="input" type="text" value="{{value}}" /><a class="pro-number-btn pro-number-btn-plus" data-pro="plus" href="javascript:void(0);">＋</a></div>',_doms:{input:"@input"},_css:{all:".pro-number,.pro-number-btn{display:inline-block}.pro-number{position:relative}.pro-number-input{font-size:100%;text-align:center;width:3em;height:2em;line-height:2em;border:solid #e0e0e0;border-width:1px 0;padding:0 .6em;vertical-align:middle;+zoom:1;outline:none}.pro-number-btn{text-align:center;width:2.5em;height:2em;line-height:2em;border:1px solid #e0e0e0;vertical-align:middle;background-color:#f5f5f5;box-sizing:content-box;outline:none;text-decoration:none;white-space:nowrap;cursor:pointer}.pro-number-btn:focus,.pro-number-btn:hover{position:relative;background-color:#fafafa;border-color:#ccc}.pro-number-btn:active{position:relative;background-color:#f0f0f0;border-color:#ccc}.pro-number-disabled .pro-number-input{background-color:#f0f0f0;color:#999}.pro-number-disabled .pro-number-btn{background:#e0e0e0!important;border-color:#ccc!important;color:#aaa!important;cursor:default!important}",iel:".pro-number,.pro-number-btn{display:inline;zoom:1}"},_baseClassName:"pro-number",_getData:function(e){return{min:"min"in e?e.min:NaN,max:"max"in e?e.max:NaN,value:e.value||0,width:e.width}},_events:{"@plus/mousedown":function(){this.fire("plusclick"),this.__timer=t.delay(function(){this.__timer=setInterval(t.bind(function(){this.fire("plusclick")},this),100)},this,400)},"@minus/mousedown":function(){this.fire("minusclick"),this.__timer=t.delay(function(){this.__timer=setInterval(t.bind(function(){this.fire("minusclick")},this),100)},this,400)},"@plus/mouseup":function(){clearTimeout(this.__timer)},"@minus/mouseup":function(){clearTimeout(this.__timer)},"@plus/mouseout":function(){clearTimeout(this.__timer)},"@minus/mouseout":function(){clearTimeout(this.__timer)},"@input/change":function(e){this.setValue(e.value)}},_listeners:{plusclick:function(){this.plus()},minusclick:function(){this.minus()}}},{setValue:function(e,t){e-=0;var n=this.model.get("max"),r=this.model.get("min");if(typeof e=="number"&&!isNaN(e)&&isFinite(e))return this.step>1&&e%this.step!=0&&(e=(Math.floor(e/this.step)+1)*this.step,this.fire("wrongInput")),!isNaN(n)&&e>n?e=n:!isNaN(r)&&e<r&&(e=r),this.doms.input.value=e,this.model.set("value",e),e;if(isNaN(e))return this.doms.input.value=this.model.get("value"),this.getValue()},getValue:function(){return this.doms.input.value-0},plus:function(){var e=this.getValue();this.setValue(e+this.step),this.fire("plus",e)},minus:function(){var e=this.getValue();this.setValue(e-this.step),this.fire("minus",e)}})}),define("welcome",["require","pro","component/numberinput"],function(e){function i(){var e=this,t=oGoods.length;e.changeGoods(t),e.renderBuy(),e.setCookie()}function s(){var e=this,r=e.getClass("goodsList",".m-count-number"),i=e.getClass("goodsList",".m-goods-msg"),s=e.getClass("goodsList",".w-goods-btn-quickBuy"),o="",u=1,a=1,f=1,l=1,c=!1;n._css={all:".pro-number-btn{text-align: center;width: 22px;height: 22px;line-height: 22px;border: 1px solid #999999;vertical-align: middle;background-color: #fff;box-sizing: content-box;color: #999999;outline: none;text-decoration: none;white-space: nowrap;cursor: pointer;}.pro-number-input{font-size: 100%;text-align: center;width: 36px;height: 20px;line-height: 20px;border: solid #999999;border-width: 1px 0;color: #666666;vertical-align: middle;outline: none;}.pro-number-btn-minus{border-top-left-radius: 3px;border-bottom-left-radius: 3px;}.pro-number-btn-plus{border-top-right-radius: 3px;border-bottom-right-radius: 3px;}",iel:".pro-number,.pro-number-btn{display:inline;zoom:1}"},oGoods[0].buyUnit==="10"&&(f=10,a=10,l=10),e.numberInput=(new n({min:a,max:e.getClass("goodsList",".existingTimes-txt").innerHTML-0,value:f,step:l})).renderBy(r),t.addEvent(s,"click",function(){var t={gid:i.getAttribute("data-gid"),name:i.getAttribute("data-gname"),price:i.getAttribute("data-price"),existingTimes:i.getAttribute("data-existingTimes"),period:i.getAttribute("data-period"),isFreeCoin:!1};u=e.numberInput.getValue(),o=G.host+"/cart/index.do?from="+G.from+"&isFreeCoin="+t.isFreeCoin+"&gid="+t.gid+"&period="+t.period+"&num="+u,this.setAttribute("href",o)})}function o(e){var n=this,r=n.getClass("goodsList",".m-opr-change"),i=1;t.addEvent(r,"click",function(){var r=oGoods[i],s=n.getClass("goodsList",".m-goods-msg"),o=n.getClass("goodsList",".m-count-number"),u=n.getClass("goodsPic","a"),a=n.getClass("goodsPic","img"),f=n.getClass("goodsTitle","a"),l=t.$("progressBarWrap"),c=n.getClass("progressBarWrap",".w-progressBar-bar"),h={"data-gid":r.gid,"data-period":r.period,"data-gname":r.gname,"data-price":r.price,"data-existingtimes":r.existingTimes},p=n.getGoodsUrl(r.gid,r.period),d=n.getGoodsImg(r.gpic,"m"),v="（第"+r.period+"期）"+r.gname,m=(r.price-0)/(r.priceUnit-0),g=m-(r.existingTimes-0),y=0,b=1,w=1,E=1,S=!1;n.setAttr(s,h),n.setAttr(u,{href:p,title:v}),a.setAttribute("src",d),n.setAttr(f,{href:p,title:v}),f.innerHTML=v,n.getClass("goodsList",".existingTimes-txt").innerHTML=g+"",g>0?y=(r.existingTimes/m*100).toFixed(1)-0:y=100,l.setAttribute("title",y+"%"),c.style.width=y+"%",r.buyUnit==="10"&&(b=10,w=10,E=10),n.numberInput.update({min:b,max:g,value:w,step:E}),i++,i===e&&(i=0)})}function u(e,t,n){var r=t?this.format(e,4):e,i=t?this.format(t||0,6):"",s="/detail/";return n&&(s="/history/"),i==""?G.host+s+r+".html":G.host+s+r.substring(0,2)+"-"+r.substring(2,4)+"-"+i.substring(0,2)+"-"+i.substring(2,4)+"-"+i.substring(4,6)+".html"}function a(e,t){var n="";switch(t){case"s":n=e[0];break;case"m":n=e[1];break;case"l":n=e[2]}return n}function f(e,t){var n=e+"";if(n.length<t)for(var r=0,i=t-n.length;r<i;r++)n="0"+n;return n}function l(e,n){return t.View.from(t.$(e)).find(n)}function c(e,t){if(typeof t=="object")for(var n in t)e.setAttribute(n+"",t[n]+"")}var t=e("pro"),n=e("component/numberinput"),r={init:i,renderBuy:s,getGoodsUrl:u,getGoodsImg:a,changeGoods:o,getClass:l,setAttr:c,format:f};return r});